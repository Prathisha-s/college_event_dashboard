<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f9f9f9; font-family: Arial, sans-serif; }
        .sidebar { height: 100vh; background-color: #343a40; color: white; padding: 20px; }
        .sidebar a { color: white; text-decoration: none; display: block; margin: 10px 0; }
        .content { padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: #fff; }
        table, th, td { border: 1px solid #ddd; }
        th, td { padding: 10px; text-align: left; }
        th { background: #28a745; color: #fff; }
        td button { background: #28a745; color: white; border: none; padding: 5px 10px; cursor: pointer; }
        td button:hover { background: #1e7e34; }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 sidebar">
            <h4>Student Dashboard</h4>
            <p>ğŸ‘¤ <span th:text="${name ?: 'Student'}">Name</span><br>ğŸ“ <span th:text="${role ?: 'ROLE_STUDENT'}">Role</span></p>
            <hr>
            <a th:href="@{/student/dashboard}">ğŸ  Browse Events</a>
            <a th:href="@{/student/my-registrations}">ğŸ“‹ My Registrations</a>
            <a th:href="@{/logout}">ğŸšª Logout</a>
        </div>

        <!-- Main Content -->
        <div class="col-md-9 content">
            <h2>Welcome, <span th:text="${name ?: 'Student'}">Student</span> ğŸ‰</h2>

            <!-- Search & Filter -->
            <form method="get" th:action="@{/student/dashboard}" class="d-flex mb-3">
                <input type="text" name="search" class="form-control me-2" placeholder="Search events..." th:value="${search ?: ''}">
                <select name="category" class="form-select me-2">
                    <option value="" th:selected="${category == null}">All Categories</option>
                    <option value="Technical" th:selected="${category == 'Technical'}">Technical</option>
                    <option value="Cultural" th:selected="${category == 'Cultural'}">Cultural</option>
                    <option value="Sports" th:selected="${category == 'Sports'}">Sports</option>
                </select>
                <button type="submit" class="btn btn-success">Filter</button>
            </form>

            <h3>Available Events:</h3>
            <div th:if="${#lists.isEmpty(events)}">No events found.</div>

            <table th:if="${!#lists.isEmpty(events)}">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Venue</th>
                        <th>Hosted By</th>
                        <th>Category</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
<tr th:each="event : ${events ?: {}}">
    <td th:text="${event.name ?: '-'}">Event Name</td>
    <td th:text="${event.description ?: '-'}">Description</td>
    <td th:text="${event.date != null ? #temporals.format(event.date,'dd-MM-yyyy') : '-'}">Date</td>
   
                        <td>
                            <span th:text="${event.startTime != null ? #temporals.format(event.startTime,'hh:mm a') : '-'}">Start</span> -
                            <span th:text="${event.endTime != null ? #temporals.format(event.endTime,'hh:mm a') : '-'}">End</span>
                        </td>
                        <td th:text="${event.venue ?: '-'}">Venue</td>
                        <td th:text="${event.hostedBy ?: '-'}">Hosted By</td>
                        <td th:text="${event.category ?: '-'}">Category</td>
                        <td>
                            <div th:if="${registeredEventIds != null and registeredEventIds.contains(event.id)}">âœ… Already Registered</div>
                            <a th:if="${registeredEventIds == null or !registeredEventIds.contains(event.id)}"
                               th:href="@{'/student/register-form/' + ${event.id}}"
                               class="btn btn-success btn-sm">Register</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>
